<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Perfil de {{ usuario.nome }}</title>
    
    <!-- 
      CORREÇÃO: Usando url_for para carregar o CSS a partir da raiz do projeto.
      O Flask irá gerar a URL /assets/TelaDeUsuario/stylesTest.css
    -->
    <link rel="stylesheet" href="{{ url_for('static', filename='TelaDeUsuario/stylesTest.css') }}">
    
    <!-- Estilos para o toast de notificação (pode ser movido para o CSS principal) -->
    <style>
        .toast {
            visibility: hidden;
            min-width: 250px;
            margin-left: -125px;
            background-color: #333;
            color: #fff;
            text-align: center;
            border-radius: 5px;
            padding: 16px;
            position: fixed;
            z-index: 101;
            left: 50%;
            bottom: 30px;
            font-size: 17px;
        }
        .toast.show {
            visibility: visible;
            animation: fadein 0.5s, fadeout 0.5s 3.5s;
        }
        @keyframes fadein { from {bottom: 0; opacity: 0;} to {bottom: 30px; opacity: 1;} }
        @keyframes fadeout { from {bottom: 30px; opacity: 1;} to {bottom: 0; opacity: 0;} }
    </style>
</head>
<body>
    <!-- 
      CORREÇÃO: Imagem de fundo carregada com url_for.
      Usa a imagem de capa do usuário se existir, senão uma padrão.
    -->
    <div class="background-image" style="background-image: url('{{ url_for('static', filename=usuario.foto_capa if usuario.foto_capa else 'TelaDeUsuario/imagens/WallpaperTest.jpg') }}');">
    </div>

    <div class="profile-container">
        <header class="profile-header">
            <!-- 
              CORREÇÃO: Imagem de perfil carregada com url_for.
              Usa a foto de perfil do banco de dados ou uma imagem padrão.
              O caminho 'telasHTML/...' foi removido pois o app.py já aponta para a raiz.
            -->
            <img src="{{ url_for('static', filename=usuario.foto_perfil if usuario.foto_perfil else 'TelaDeUsuario/imagens/user-icon-placeholder.png') }}" alt="Foto de Perfil de {{ usuario.nome }}" class="profile-picture">
            
            <div class="profile-info">
                <h1>{{ usuario.nome or 'Nome do Usuário' }}</h1>
                <p>{{ usuario.posicao or 'Posição não definida' }}</p>
            </div>
            
            <!-- 
              CORREÇÃO: Imagem do logo no header carregada com url_for.
              Usei o caminho que você me passou.
            -->
            <img src="{{ url_for('static', filename='telasHTML/ArquivosGerais/TelaInicial/bolaLogo.png') }}" alt="Logo" class="header-logo">
        </header>

        <main class="profile-content">
            <div class="info-grid">
                <div class="info-item">
                    <span class="label">Idade</span>
                    <!-- Assumindo que 'idade' é um atributo do objeto 'usuario' -->
                    <span class="value">{{ usuario.idade or 'N/A' }} anos</span>
                </div>
                <div class="info-item">
                    <span class="label">Cidade</span>
                    <span class="value">{{ usuario.cidade or 'Não informada' }}</span>
                </div>
                <div class="info-item">
                    <span class="label">Número da Camisa</span>
                    <span class="value">#{{ usuario.numero_camisa or 'N/A' }}</span>
                </div>
                <div class="info-item">
                    <span class="label">Contato (WhatsApp)</span>
                    <span class="value">{{ usuario.numero or 'Não informado' }}</span>
                </div>
            </div>

            <div class="profile-actions">
                <a href="{{ url_for('editar_perfil') }}" class="btn-edit">Editar Perfil</a>
                <a href="{{ url_for('pagina_inicial') }}" class="btn-back">Voltar para Início</a>
            </div>
        </main>
    </div>

    <!-- Div para exibir mensagens flash (toast) -->
    <div id="toast-notification" class="toast"></div>

    <!-- 
      CORREÇÃO: Carregando o script JS com url_for.
    -->
    <script src="{{ url_for('static', filename='TelaDeUsuario/script.js') }}"></script>

    <script>
        // Script para exibir mensagens flash (toast) de forma segura
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                (function() {
                    // Usa 'tojson' para evitar erros com caracteres especiais na mensagem
                    const message = {{ messages[0][1] | tojson }};
                    const category = {{ messages[0][0] | tojson }};
                    
                    const toast = document.getElementById("toast-notification");
                    toast.textContent = message;
                    
                    if (category === 'success') {
                        toast.style.backgroundColor = 'green';
                    } else if (category === 'danger') {
                        toast.style.backgroundColor = '#f44336';
                    } else {
                        toast.style.backgroundColor = '#333'; // Cor padrão
                    }
                    
                    toast.classList.add("show");
                })();
            {% endif %}
        {% endwith %}
    </script>
</body>
</html>
