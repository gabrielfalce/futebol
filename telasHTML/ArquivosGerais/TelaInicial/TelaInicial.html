<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tela Inicial</title>
    <!-- Usando url_for para garantir que o caminho do CSS esteja sempre correto -->
    <link rel="stylesheet" href="{{ url_for('serve_inicial_static', filename='style.css') }}">
</head>
<body>
    <header class="page-header">
        <div class="logo-container">
            <!-- Corrigindo também o caminho da logo para usar a rota correta -->
            <img src="{{ url_for('serve_loading_static', filename='logoGeral.png') }}" alt="Logo">
        </div>
        <h1 class="titulo">Tela Inicial</h1>
    </header>

    <div class="search-container">
        <input type="text" id="search" placeholder="Buscar usuários..." onkeyup="searchUsers()">
        <img src="{{ url_for('serve_inicial_static', filename='lupa.png') }}" alt="Lupa" class="search-icon">
    </div>

    <div class="user-list" id="user-list">
    {% for user in usuarios %}
        {% if user.id != session.user_id %} 
            <a href="{{ url_for('pagina_chat', destinatario_id=user.id) }}" class="user-card-link">
                <div class="user-card">
                    
                    <!-- 
                        *** A GRANDE MUDANÇA ESTÁ AQUI ***
                        Vamos usar a tag <object> que é mais robusta para lidar com tipos de arquivo.
                        Ela tem um fallback embutido: se não conseguir carregar a imagem, ela mostra o texto dentro dela.
                    -->
                    <object 
                        data="{{ user.profile_image_url or url_for('serve_inicial_static', filename='iconuser.png') }}" 
                        type="image/png" 
                        class="user-card-avatar {% if not user.profile_image_url %}avatar-fallback{% endif %}">
                        <!-- Este texto só aparecerá se a imagem falhar em carregar -->
                        Imagem de perfil indisponível
                    </object>

                    <!-- ... código anterior ... -->
<div class="user-card">
    <!-- Adiciona a imagem de perfil do usuário -->
    <img src="{{ user.profile_image_url or 'data:image/jpeg;base64,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4IXKnmgWrOory2acPhpPO2yLSyjlE07h7RFs8r8DqtZtPTw6LaOVeN1b3ve/Y2gamqdnsiwsxnAv2bADcBbhkdjcHwyKlgjp4GBkUbdlrR+JJ4km5JO8lMIwqGlhZBTxtjiYLNYPxJO8knMk5lexV7aUisCIiOxERAREQEREBERAREQEREBERAUN0v1b0WIF0mz2NQc+3jAG0ecjNz+/I9VMkRJiJ8tbNI9WGI0m05sfhEQ3SQAvdb2ovOB7todVDHtIJaQQ4GxaciDyIO5bjLHYrgVLVC1RTwS8i9jXOHc4i4+CjG2CJ8NSUWxVbqhwuS+zHNET+7mefkJNoBYmTUfSejVVg7+yd+TAjOcFlForyZqPpONXWfARD82FZSi1O4YzzxUy+/KW/wBINQ+xZrz/APB3qV6Pau8RrCCyB0UZ/bT3hbbmGkbTvgLdVsLhGjFFSZ09NBG7dthgMnxefGPzWXR3XBHur/RHVTR0ZbJP9ZnGYc9oETXc2RZi45uJPKysBEVbxER4EREUREQEREBERAREQEREBERAREQEREBF1STWXjlrCgyK42gsFLXuXimxJw5o55JTtjmFx2g5hQyTFnDmvM/HD1ROSedoOYXIkHMKAtx09V6I8YcUOabhwXN1EosTd1Xthryi8kgRYyKtK9kc10dO9EBRAREQEREBERAREQEREBERAREQEREHw6MFed9GCvWiDFyYZfkvLJg9+CzyImkZfgXRdTtH+ilaInFExo/0XazAuik6IcYYCPBrcF6Y8LsssiLp446IBelkQC+0RRERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQf//Z' }}" 
         alt="Foto de perfil de {{ user.nome }}" 
         class="user-card-avatar">
    
    <div class="user-card-info">

                </div>
            </a>
        {% endif %}
    {% endfor %}
    </div>

    <!-- Bloco de Notificação (Toast) -->
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            <div id="toast-notification" 
                 class="toast" 
                 data-message="{{ messages[0][1] }}" 
                 data-category="{{ messages[0][0] }}">
            </div>
        {% else %}
            <div id="toast-notification" class="toast"></div>
        {% endif %}
    {% endwith %}

    <!-- Links de Navegação -->
    <div class="navigation-links">
        <a href="{{ url_for('pagina_feed') }}" class="nav-button feed-button">Ver Feed</a>
        <a href="{{ url_for('pagina_usuario') }}" class="nav-button profile-button">Ver Perfil</a>
        <a href="{{ url_for('logout') }}" class="nav-button logout-button">Sair</a>
    </div>

    <script>
        // Função de busca de usuários
        function searchUsers() {
            const input = document.getElementById("search").value.toLowerCase();
            const cards = document.querySelectorAll(".user-card-link");
            
            cards.forEach(cardLink => {
                const text = cardLink.textContent.toLowerCase();
                cardLink.style.display = text.includes(input) ? "block" : "none";
            });
        }

        // Lógica para exibir a notificação
        document.addEventListener('DOMContentLoaded', (event) => {
            const toast = document.getElementById("toast-notification");
            
            if (toast.dataset.message) {
                toast.textContent = toast.dataset.message;
                toast.style.backgroundColor = toast.dataset.category === 'success' 
                    ? 'var(--cor-primaria)' 
                    : '#ff4d4d';
                
                toast.classList.add("show");
                setTimeout(() => {
                    toast.classList.remove("show");
                }, 4000);
            }
        });
    </script>
</body>
</html>
